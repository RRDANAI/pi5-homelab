# Private Tailscale domain (UI + API allowed, internal use)
racknerd-b406ebf.tailf84e24.ts.net {
	# Caddy 2.5+ will fetch this .ts.net certificate from the local Tailscale daemon:contentReference[oaicite:0]{index=0}
	reverse_proxy 127.0.0.1:5678 {
		flush_interval -1
	}
	# Proxy all requests to n8n (UI and API fully accessible on the tailnet domain)
}

# Public domain for webhooks (only specific paths allowed)
nerdrack.maroonoven.work {
	# Only allow n8n webhook endpoints on the public domain (deny UI/API access here)
	@webhooks path /webhook* # matches /webhook, /webhook-test, /webhook-waiting, etc.:contentReference[oaicite:1]{index=1}
	handle @webhooks {
		reverse_proxy 127.0.0.1:5678 # forward allowed webhook requests to n8n
	}
	handle {
		respond "Forbidden" 403 # block any non-webhook requests on this domain
	}
}
